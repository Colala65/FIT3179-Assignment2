{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Meat Production by Type (1961â€“2018)",
  "width": 900,
  "height": 600,
  "padding": 2.5,
  "autosize": "none",

  "data": [
    {
      "name": "tree",
      "url": "https://raw.githubusercontent.com/Colala65/FIT3179-Week10-HW/main/Week-10-Homework-Code/data/meat_production_cleaned.csv",
      "transform": [
        {
          "type": "stratify",
          "key": "Entity",
          "parentKey": "Year"
        },
        {
          "type": "treemap",
          "field": "size",
          "sort": {"field": "value"},
          "round": true,
          "method": {"signal": "layout"},
          "ratio": {"signal": "aspectRatio"},
          "size": [{"signal": "width"}, {"signal": "height"}]

        }
      ]
    },
    {
      "name": "nodes",
      "source": "tree",
      "transform": [{ "type": "filter", "expr": "datum.children" }]
    },
    {
      "name": "leaves",
      "source": "tree",
      "transform": [{ "type": "filter", "expr": "!datum.children" }]
    }
  ]

  "data": {
    "url": "https://raw.githubusercontent.com/Colala65/FIT3179-Week10-HW/main/Week-10-Homework-Code/data/meat_production_cleaned.csv"   
  },
  "params": [
    {
      "name": "Year_selection",
      "value": 2018,
      "bind": {"input": "range", "min": 1961, "max": 2018, "step": 1, "name": "Year: "}
    }
  ],
  "transform": [
    {"filter": "datum.Year == Year_selection"},
    {"filter": "datum.Production > 0"},
    {"calculate": "datum.Production/datum.Population * 1000", "as": "Production per population"}
],

  "layer": [
    {
      "mark": "circle",
      "encoding": {
        "x": {
          "field": "GDP per capita",
          "type": "quantitative",
          "axis": {"tickCount": 4},
          "scale": {"type": "log", "domain": [1, 10000000]}
        },
        "y": {
          "field": "Consumption",
          "type": "quantitative",
          "title": "Consumption (kg per person)",
          "axis": {"tickCount": 4},
          "scale": {"type": "log", "domain": [1, 1000000]}
        },
        "color": {
          "field": "Entity",
          "type": "nominal"
        },

        "opacity": {
          "value": 0.6
        },

        "tooltip": [
          {"field": "Year", "type": "quantitative"},
          {"field": "Entity", "type": "nominal"},
          {"field": "GDP per capita", "type": "quantitative", "format": ","},
          {"field": "Consumption", "type": "quantitative", "format": ","}
          ]
      }
    }
  ]
}
